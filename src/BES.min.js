function BasylEncryptor(){function u(a,c,f){for(var b=0;16>b;b++)f?h.push(a[b]):h.push(Math.floor(1E4*Math.random())%256);for(b=0;b<e;b++)d.push(b*b+b+h[b%16]);for(b=0;b<c.length;b++)d[b]+=c.charCodeAt(b);g=[];l=[];for(a=0;256>a;a++)g.push(a),l.push(a);for(b=m=0;20>b;b++)p(),3!=b&&9!=b&&13!=b||v(),q(),4!=b&&8!=b&&p();k=0;w(10);r()}function w(a){for(var c=0;c<a;c++)for(var f=0;256>f;f++)t(f),x(f),t(h[f%16])}function p(){for(var a=1;a<e;a++)d[a]+=d[a-1],d[a]%=913137}function y(a){var c=d[k++]%256,f=
g[c];l[f]=a;l[g[a]]=c;g[c]=g[a];g[a]=f}function z(a,c){a=Math.abs(a);return 0>=c?(m=a%e,d[m]):z(d[a%e]%e,c-1)}function v(){for(var a=0;a<e;a++){var c=d[a];z(d[a]%e,(c<<2^c>>2)%8+1);d[a]=d[m];d[m]=c}}function q(){for(var a=e-2;0<=a;a--)d[a]+=d[a+1],d[a]%=913122}function t(a){a=Math.abs(a)&255;var c=g[a];y(a);return c}function x(a){a=Math.abs(a)&255;a=l[a];y(a);return a}function r(){for(var a=k=0;a<n.length;a++)d[a]+=n.charCodeAt(a);p();q();v();q();w(2);k=0}var m=0,k=0,d=null,h=null,e=null,n=null,g=
null,l=null;this.encryptString=function(a,c,f,b,d){d="undefined"!==typeof d?d:!1;for(var e=[],g=0;g<a.length;g++)d?(e.push(a.charCodeAt(g)>>8&255),e.push(a.charCodeAt(g)&255)):e.push(a.charCodeAt(g));return this.encrypt(e,c,f,b)};this.encrypt=function(a,c,f,b){d=[];h=[];n=b;e=f;u(null,c,!1);c=[];for(b=0;16>b;b++)c.push(h[b]);for(b=0;b<a.length;b++)k>=f&&r(),c.push(t(a[b]));return c};this.decryptString=function(a,c,d,b,e){e="undefined"!==typeof e?e:!1;a=this.decrypt(a,c,d,b);c="";for(d=0;d<a.length;d++)c=
e?c+String.fromCharCode(a[d++]<<8|a[d]):c+String.fromCharCode(a[d]);return c};this.decrypt=function(a,c,f,b){d=[];h=[];n=b;e=f;u(a,c,!0);c=[];for(b=16;b<a.length;b++)k>=f&&r(),c.push(x(a[b]));return c}}"undefined"!==typeof module&&"undefined"!==typeof module.exports&&(module.exports=BasylEncryptor);
