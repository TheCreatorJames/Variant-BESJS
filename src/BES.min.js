function BasylEncryptor(){function r(r,t,o){for(var i=0;l>i;i++)o?g.push(r[i]):g.push(Math.floor(1e4*Math.random())%256);for(var i=0;d>i;i++)p.push(i*i+i+g[i%l]);for(var i=0;i<t.length;i++)p[i]+=t.charCodeAt(i);C=[],A=[];for(var e=0;256>e;e++)C.push(e),A.push(e);v=0;for(var i=0;20>i;i++)n(),(3==i||9==i||13==i)&&u(),f(),4!=i&&8!=i&&n();s=0;for(var y=0;10>y;y++)for(var e=0;256>e;e++)a(e),h(e),a(g[e%l]);s=0,c()}function n(){for(var r=1;d>r;r++)p[r]+=p[r-1],p[r]%=913137}function t(r){var n=p[s++]%256,t=C[n];A[t]=r,A[C[r]]=n,C[n]=C[r],C[r]=t}function o(r,n){return r=Math.abs(r),0>=n?(v=r%d,p[v]):o(p[r%d]%d,n-1)}function u(){for(var r=0;d>r;r++){var n=p[r];o(p[r]%d,(n<<2^n>>2)%8+1),p[r]=p[v],p[v]=n}}function f(){for(var r=d-2;r>=0;r--)p[r]+=p[r+1],p[r]%=913122}function a(r){var n=C[r];return t(r),n}function h(r){var n=A[r];return t(n),n}function c(){s=0;for(var r=0;r<y.length;r++)p[r]+=y.charCodeAt(r);n(),f(),u(),f(),s=0}function i(r){d=r}function e(r){y=r}var l=16,v=0,s=0,p=null,g=null,d=null,y=null,C=null,A=null;this.encryptString=function(r,n,t,o){for(var u=[],f=0;f<r.length;f++)u.push(r.charCodeAt(f));return this.encrypt(u,n,t,o)},this.encrypt=function(n,t,o,u){p=[],g=[],e(u),i(o),r(null,t,!1);for(var f=[],h=0;l>h;h++)f.push(g[h]);for(h=0;h<n.length;h++)s>=o&&c(),f.push(a(n[h]));return f},this.decryptString=function(r,n,t,o){for(var u=this.decrypt(r,n,t,o),f="",a=0;a<u.length;a++)f+=String.fromCharCode(u[a]);return f},this.decrypt=function(n,t,o,u){p=[],g=[],e(u),i(o),r(n,t,!0);for(var f=[],a=l;a<n.length;a++)s>=o&&c(),f.push(h(n[a]));return f}}
