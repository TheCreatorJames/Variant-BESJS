function BasylEncryptor(){function r(r,o,u){for(var h=0;v>h;h++)u?d.push(r[h]):d.push(Math.floor(1e4*Math.random())%256);for(var h=0;y>h;h++)g.push(h*h+h+d[h%v]);for(var h=0;h<o.length;h++)g[h]+=o.charCodeAt(h);A=[],M=[];for(var c=0;256>c;c++)A.push(c),M.push(c);s=0;for(var h=0;20>h;h++)t(),(3==h||9==h||13==h)&&f(),a(),4!=h&&8!=h&&t();p=0,n(10),i()}function n(r){for(var n=0;r>n;n++)for(var t=0;256>t;t++)h(t),c(t),h(d[t%v])}function t(){for(var r=1;y>r;r++)g[r]+=g[r-1],g[r]%=913137}function o(r){var n=g[p++]%256,t=A[n];M[t]=r,M[A[r]]=n,A[n]=A[r],A[r]=t}function u(r,n){return r=Math.abs(r),0>=n?(s=r%y,g[s]):u(g[r%y]%y,n-1)}function f(){for(var r=0;y>r;r++){var n=g[r];u(g[r]%y,(n<<2^n>>2)%8+1),g[r]=g[s],g[s]=n}}function a(){for(var r=y-2;r>=0;r--)g[r]+=g[r+1],g[r]%=913122}function h(r){var n=A[r];return o(r),n}function c(r){var n=M[r];return o(n),n}function i(){p=0;for(var r=0;r<C.length;r++)g[r]+=C.charCodeAt(r);t(),a(),f(),a(),n(2),p=0}function e(r){y=r}function l(r){C=r}var v=16,s=0,p=0,g=null,d=null,y=null,C=null,A=null,M=null;this.encryptString=function(r,n,t,o){for(var u=[],f=0;f<r.length;f++)u.push(r.charCodeAt(f));return this.encrypt(u,n,t,o)},this.encrypt=function(n,t,o,u){g=[],d=[],l(u),e(o),r(null,t,!1);for(var f=[],a=0;v>a;a++)f.push(d[a]);for(a=0;a<n.length;a++)p>=o&&i(),f.push(h(n[a]));return f},this.decryptString=function(r,n,t,o){for(var u=this.decrypt(r,n,t,o),f="",a=0;a<u.length;a++)f+=String.fromCharCode(u[a]);return f},this.decrypt=function(n,t,o,u){g=[],d=[],l(u),e(o),r(n,t,!0);for(var f=[],a=v;a<n.length;a++)p>=o&&i(),f.push(c(n[a]));return f}}
