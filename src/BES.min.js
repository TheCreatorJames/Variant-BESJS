function BasylEncryptor(){var i=16;var h=0;var j=0;var r=null;var b=null;var o=null;var e=null;var t=null;var s=null;function u(x,w,A){for(var n=0;n<i;n++){if(A){b.push(x[n])}else{b.push(Math.floor(Math.random()*10000)%256)}}for(var n=0;n<o;n++){r.push(n*n+n+b[n%i])}for(var n=0;n<w.length;n++){r[n]+=w.charCodeAt(n)}t=[];s=[];for(var y=0;y<256;y++){t.push(y);s.push(y)}h=0;for(var n=0;n<20;n++){l();if(n==3||n==9||n==13){c()}g();if(!(n==4||n==8)){l()}}j=0;k(10);m()}function k(x){for(var n=0;n<x;n++){for(var w=0;w<256;w++){a(w);p(w);a(b[w%i])}}}function l(){for(var n=1;n<o;n++){r[n]+=r[n-1];r[n]%=913137}}function q(x){var n=r[j++]%256;var w=t[n];s[w]=x;s[t[x]]=n;t[n]=t[x];t[x]=w}function d(w,n){w=Math.abs(w);if(n<=0){h=w%o;return r[h]}return d(r[w%o]%o,n-1)}function c(){for(var w=0;w<o;w++){var n=r[w];d(r[w]%o,((n<<2)^(n>>2))%8+1);r[w]=r[h];r[h]=n}}function g(){for(var n=o-2;n>=0;n--){r[n]+=r[n+1];r[n]%=913122}}function a(w){var n=t[w];q(w);return n}function p(w){var n=s[w];q(n);return n}function m(){j=0;for(var n=0;n<e.length;n++){r[n]+=e.charCodeAt(n)}l();g();c();g();k(2);j=0}function v(n){o=n}function f(n){e=n}this.encryptString=function(A,z,x,y){var n=[];for(var w=0;w<A.length;w++){n.push(A.charCodeAt(w))}return this.encrypt(n,z,x,y)};this.encrypt=function(w,A,y,z){r=[];b=[];f(z);v(y);u(null,A,false);var n=[];for(var x=0;x<i;x++){n.push(b[x])}for(x=0;x<w.length;x++){if(j>=y){m()}n.push(a(w[x]))}return n};this.decryptString=function(x,B,z,A){var w=this.decrypt(x,B,z,A);var n="";for(var y=0;y<w.length;y++){n+=String.fromCharCode(w[y])}return n};this.decrypt=function(w,A,y,z){r=[];b=[];f(z);v(y);u(w,A,true);var n=[];for(var x=i;x<w.length;x++){if(j>=y){m()}n.push(p(w[x]))}return n}}if(typeof(module)==="undefined"||typeof(module.exports)==="undefined"){}else{module.exports=BasylEncryptor};