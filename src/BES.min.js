function BasylEncryptor(){this.Decrypt=function(r,n,o,a){function t(){for(var r=1;o>r;r++)p[r]+=p[r-1],p[r]%=913137}function f(r,n){return r=Math.abs(r),0>=n?(y=r%o,p[y]):f(p[r%o]%o,n-1)}function v(){for(var r=0;o>r;r++){var n=p[r];f(p[r]%o,(n<<2^n>>2)%8+1),p[r]=p[y],p[y]=n}}function u(){for(var r=o-2;r>=0;r--)p[r]+=p[r+1],p[r]%=913122}function e(r){var n=p[S++],o=d[n];C[o]=r,C[d[r]]=n,d[n]=d[r],d[r]=o}function c(r){var n=d[r];return e(r),n}function h(r){var n=C[r];return e(n),n}function i(){S=0;for(var r=0;r<a.length;r++)p[r]+=a.charCodeAt(r);t(),u(),v(),u();for(var r=0;o>r;r++)p[r]%=256;S=0}var p=[];r=r.replace("[ ",""),r=r.replace(" ]",""),r=r.split(" ");for(var s=[],l=16,g=0;l>g;g++)s.push(parseInt(r[g],16));for(var g=0;o>g;g++)p.push(g*g+g+s[g%l]);for(var g=0;g<n.length;g++)p[g]+=n.charCodeAt(g);for(var d=[],C=[],A=0;256>A;A++)d.push(A),C.push(A);for(var y=0,g=0;20>g;g++)t(),(3==g||9==g||13==g)&&v(),u(),4!=g&&8!=g&&t();for(var M=0,g=0;o>g;g++)p[g]%=256,M+=p[g];for(var S=0,b=0;10>b;b++)for(var A=0;256>A;A++)c(A),h(A),c(s[A%l]);S=0;for(var m="",g=l;g<r.length;g++)S>=o&&i(),m+=String.fromCharCode(h(parseInt(r[g],16)))+"";return unescape(m)},this.Encrypt=function(r,n,o,a){function t(){for(var r=1;o>r;r++)p[r]+=p[r-1],p[r]%=913137}function f(r,n){return r=Math.abs(r),0>=n?(y=r%o,p[y]):f(p[r%o]%o,n-1)}function v(){for(var r=0;o>r;r++){var n=p[r];f(p[r]%o,(n<<2^n>>2)%8+1),p[r]=p[y],p[y]=n}}function u(){for(var r=o-2;r>=0;r--)p[r]+=p[r+1],p[r]%=913122}function e(r){var n=p[S++],o=d[n];C[o]=r,C[d[r]]=n,d[n]=d[r],d[r]=o}function c(r){var n=d[r];return e(r),n}function h(r){var n=C[r];return e(n),n}function i(){S=0;for(var r=0;r<a.length;r++)p[r]+=a.charCodeAt(r);t(),u(),v(),u();for(var r=0;o>r;r++)p[r]%=256;S=0}for(var p=[],s=[],l=16,g=0;l>g;g++)s.push(Math.floor(1e4*Math.random())%256);for(var g=0;o>g;g++)p.push(g*g+g+s[g%l]);for(var g=0;g<n.length;g++)p[g]+=n.charCodeAt(g);for(var d=[],C=[],A=0;256>A;A++)d.push(A),C.push(A);for(var y=0,g=0;20>g;g++)t(),(3==g||9==g||13==g)&&v(),u(),4!=g&&8!=g&&t();for(var M=0,g=0;o>g;g++)p[g]%=256,M+=p[g];for(var S=0,b=0;10>b;b++)for(var A=0;256>A;A++)c(A),h(A),c(s[A%l]);S=0,r=escape(r),r=r.replace(/\%20/g," ");for(var m="[ ",g=0;l>g;g++)m+=s[g].toString(16)+" ";for(g=0;g<r.length;g++)S>=o&&i(),m+=c(r.charCodeAt(g)).toString(16)+" ";return m+"]"}}