function BasylEncryptor(){function r(r,t,o){for(var c=0;l>c;c++)o?g.push(r[c]):g.push(Math.floor(1e4*Math.random())%256);for(var c=0;d>c;c++)p.push(c*c+c+g[c%l]);for(var c=0;c<t.length;c++)p[c]+=t.charCodeAt(c);C=[],A=[];for(var i=0;256>i;i++)C.push(i),A.push(i);v=0;for(var c=0;20>c;c++)n(),(3==c||9==c||13==c)&&u(),f(),4!=c&&8!=c&&n();s=0;for(var e=0;10>e;e++)for(var i=0;256>i;i++)a(i),h(i),a(g[i%l]);s=0}function n(){for(var r=1;d>r;r++)p[r]+=p[r-1],p[r]%=913137}function t(r){var n=p[s++]%256,t=C[n];A[t]=r,A[C[r]]=n,C[n]=C[r],C[r]=t}function o(r,n){return r=Math.abs(r),0>=n?(v=r%d,p[v]):o(p[r%d]%d,n-1)}function u(){for(var r=0;d>r;r++){var n=p[r];o(p[r]%d,(n<<2^n>>2)%8+1),p[r]=p[v],p[v]=n}}function f(){for(var r=d-2;r>=0;r--)p[r]+=p[r+1],p[r]%=913122}function a(r){var n=C[r];return t(r),n}function h(r){var n=A[r];return t(n),n}function c(){s=0;for(var r=0;r<y.length;r++)p[r]+=y.charCodeAt(r);n(),f(),u(),f();for(var r=0;d>r;r++)p[r]%=256;s=0}function i(r){d=r}function e(r){y=r}var l=16,v=0,s=0,p=null,g=null,d=null,y=null,C=null,A=null;this.encryptString=function(r,n,t,o){for(var u=[],f=0;f<r.length;f++)u.push(r.charCodeAt(f));return this.encrypt(u,n,t,o)},this.encrypt=function(n,t,o,u){p=[],g=[],e(u),i(o),r(null,t,!1);for(var f=[],h=0;l>h;h++)f.push(g[h]);for(h=0;h<n.length;h++)s>=o&&c(),f.push(a(n[h]));return f},this.decryptString=function(r,n,t,o){for(var u=this.decrypt(r,n,t,o),f="",a=0;a<u.length;a++)f+=String.fromCharCode(u[a]);return f},this.decrypt=function(n,t,o,u){p=[],g=[],e(u),i(o),r(n,t,!0);for(var f=[],a=l;a<n.length;a++)s>=o&&c(),f.push(h(n[a]));return f}}
